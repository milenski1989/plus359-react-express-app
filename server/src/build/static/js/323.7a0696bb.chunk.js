"use strict";(self.webpackChunkplus359gallery_frontend_react=self.webpackChunkplus359gallery_frontend_react||[]).push([[323],{8323:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var a=s(2791),r=s(3239),n=s(697),i=s(2680),o=s(5356),l=s(4294),d=(s(1672),s(6265)),p=s(3151),c=s(4569),u=s.n(c),m=s(1129),g=s(184);const h=()=>{let e=window.localStorage,t=JSON.parse(e.getItem("user"));const[s,c]=(0,a.useState)({title:"",technique:"",dimensions:"",price:0,notes:""}),[h,x]=(0,a.useState)({storageLocation:"",cell:"",position:0,artist:""}),[f,v]=(0,a.useState)({error:!1,message:""}),[w,y]=(0,a.useState)(0),[j,b]=(0,a.useState)(),[C,S]=(0,a.useState)(!1),[Z,q]=(0,a.useState)(!1),[k,N]=(0,a.useState)([]),[F,L]=(0,a.useState)(""),[_,B]=(0,a.useState)(!1),D=async()=>{const e=await fetch("artworks-management-app.vercel.app/artists/relatedToEntries"),t=await e.json();N(t)};(0,a.useEffect)((()=>{D()}),[]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(d.Z,{open:f.error,handleClose:()=>v({error:!1,message:""}),message:f.message,severity:"error"}),(0,g.jsx)(d.Z,{open:Z,handleClose:()=>q(!1),message:"Entry uploaded successfully!",severity:"success"}),(0,g.jsx)(p.Z,{}),C?(0,g.jsx)(r.Z,{variant:"determinate",value:w,className:"loader",color:"primary"}):(0,g.jsxs)(n.Z,{component:"section",sx:{display:"flex",flexDirection:"column",margin:"3rem auto",marginTop:"4rem",width:"60vw"},children:[(0,g.jsx)(i.Z,{onChange:e=>{const t=e.target.files[0];b(t)},id:"textField",type:"file",autoComplete:"current-password",required:!0,className:"peer cursor-pointer block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"}),(0,g.jsx)("p",{className:"invisible peer-invalid:visible text-red-400 mt-0",children:"Please upload an image"}),(0,g.jsx)(o.Z,{disablePortal:!0,options:k,renderInput:e=>(0,g.jsx)(i.Z,{...e,label:"Artists"}),onChange:(e,t)=>(async e=>{e?(L(""),B(!0),x((t=>({...t,artist:e})))):B(!1)})(t),required:!0,sx:{marginBottom:"1rem"}}),(0,g.jsx)(i.Z,{label:"Add a new artist",value:F,disabled:_,onChange:e=>(e=>{B(!1),L(e.target.value),x((t=>({...t,artist:e.target.value})))})(e),sx:{marginBottom:"1rem",width:"60vw"}}),Object.entries(s).map((e=>{let[t,s]=e;return(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"flex items-center justify-between"}),(0,g.jsx)(i.Z,{label:t,value:s,onChange:e=>((e,t)=>{c((s=>({...s,[e]:t.target.value})))})(t,e),id:"textField",name:t,required:"technique"===t||"title"===t,sx:{marginBottom:"1rem",width:"60vw"}})]},t)})),(0,g.jsx)(m.Z,{setFormControlData:x}),(0,g.jsx)(l.Z,{onClick:async()=>{try{const e=e=>{const t=Math.round(100*e.loaded/e.total);y(t)};S(!0);const a=new FormData;a.append("file",j),a.append("artist",s.artist||h.artist),a.append("title",s.title),a.append("technique",s.technique),a.append("dimensions",s.dimensions),a.append("price",s.price),a.append("notes",s.notes),a.append("storageLocation",h.storageLocation),a.append("cell",h.cell),a.append("position",h.position),a.append("by_user",t.userName),await u().post("artworks-management-app.vercel.app/s3/upload",a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e}),D(),L(""),y(0),S(!1),q(!0),c({title:"",technique:"",dimensions:"",price:0,notes:""}),x({storageLocation:"",cell:"",position:0})}catch(e){y(0),S(!1),q(!1),v({error:!0,message:e.response.data.error})}},sx:{mt:2},type:"submit",variant:"contained",disabled:!j||!s.technique||!s.title||!h.artist||!h.storageLocation,children:"Upload"})]})]})}}}]);
//# sourceMappingURL=323.7a0696bb.chunk.js.map